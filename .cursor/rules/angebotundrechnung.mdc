Sehr gut ‚Äì dieser Abschnitt geh√∂rt zu den wichtigsten *Konfigurations-Modulen* einer professionellen ERP-Software. Damit trennst du Design- und Firmendaten (Logo, Bank, Zertifikate) sauber von den eigentlichen Angebots- und Rechnungsprozessen.
Hier ist deine **Roadmap im Klartext-Format**, so dass du sie direkt in Cursor AI oder als internes Konzept √ºbernehmen kannst:

---

# üß≠ **ROADMAP: Angebots- und Rechnungsvorlagen in den Einstellungen**

---

## **Zielsetzung**

In den allgemeinen **Einstellungen** der Ger√ºstbau-ERP-Software soll ein eigener Bereich (‚ÄûVorlagen & Firmendaten‚Äú) geschaffen werden.
Darin kann der Admin **Design- und Firmenelemente** f√ºr Angebote und Rechnungen konfigurieren, sodass diese Daten automatisch in den PDF-Vorlagen verwendet werden.
Zudem k√∂nnen **mehrere Layout-Vorlagen** ausgew√§hlt werden, aus denen Nutzer beim Erstellen von Angeboten oder Rechnungen w√§hlen k√∂nnen.

Das Ziel ist eine flexible, zentral gepflegte Grundlage f√ºr das Corporate Design und die rechtlichen Angaben der Dokumente.

---

## **1Ô∏è‚É£ Aufbau & Struktur**

### **Ort im System**

* Untermen√ºpunkt in **Einstellungen ‚Üí Vorlagen & Firmendaten**
* Unterteilt in Tabs oder Sektionen:

  1. **Firmendaten**
  2. **Logos & Zertifikate**
  3. **Bankinformationen**
  4. **Angebotsvorlagen**
  5. **Rechnungsvorlagen**
  6. **Vorschau**

---

## **2Ô∏è‚É£ Funktionen im Detail**

### **A. Firmendaten**

* Eingabefelder:

  * Firmenname
  * Adresse
  * Steuernummer / USt-ID
  * E-Mail, Telefonnummer, Website
  * Standard-Fu√üzeile (rechtliche Hinweise, Datenschutz, Haftungsausschluss)
* Speicherung in zentraler Config-Collection (`company_settings`)

**Ziel:** Alle Standardinformationen zentral pflegen, damit sie automatisch auf jedem Dokument erscheinen.

---

### **B. Logos & Zertifikate**

* Upload-Felder:

  * Firmenlogo (f√ºr Kopfzeile)
  * Sekund√§res Logo (z. B. Partner- oder Zertifikatslogo)
  * Zertifikatsnachweis (z. B. DIN EN 12811, SCC, T√úV)
* Upload-Vorschau mit Drag-and-Drop-Funktion
* Speicherung im MinIO-Bucket `/settings/assets/{companyId}`

**Ziel:** Einheitliches Corporate Branding in allen PDFs.

---

### **C. Bankinformationen**

* Eingabe:

  * Bankname
  * IBAN / BIC
  * Zahlungsziel (z. B. 14 Tage netto)
  * Standard-Verwendungszweck
  * QR-Code oder SEPA-Zahlungscode (optional generiert)
* Checkbox ‚ÄûStandard-Konto f√ºr alle Rechnungen‚Äú

**Ziel:** Einheitliche Abrechnungsbasis f√ºr alle Zahlungsdokumente.

---

### **D. Angebotsvorlagen**

* Auswahl aus **drei Designvarianten** (z. B. modern, klassisch, kompakt)
* Vorschau jeder Vorlage als Miniatur (PDF- oder Bild-Ansicht)
* M√∂glichkeit zur Konfiguration:

  * Kopf-/Fu√üzeilenh√∂he
  * Platzierung von Logos
  * Schriftart / Farbgestaltung
  * Positionierung der Angebotsdetails (linksb√ºndig, zentriert etc.)
* Speicherung der gew√§hlten Vorlage in `settings.offer_template = "modern"`

**Ziel:** Gestaltung der Angebots-PDFs nach Unternehmensidentit√§t und CI-Vorgaben.

---

### **E. Rechnungsvorlagen**

* Analog zu den Angebotsvorlagen:

  * Drei w√§hlbare Layouts
  * Option f√ºr Zusatzfelder (Leistungszeitraum, Zahlungsziel, Skonto, Verwendungszweck)
* Vorschaufunktion: Live-Darstellung mit Platzhaltern (Logo, Kundendaten, Rechnungsnummer etc.)
* Speicherung in `settings.invoice_template = "klassisch"`

**Ziel:** Einheitliche, professionelle und gesetzeskonforme Rechnungsdarstellung.

---

### **F. Vorschau**

* Dynamische Vorschau innerhalb der Seite:

  * Beispiel-PDF mit allen gesetzten Konfigurationen (Logo, Adresse, Bankdaten etc.)
  * Wechsel zwischen ‚ÄûAngebotsvorschau‚Äú und ‚ÄûRechnungsvorschau‚Äú
  * Aktualisierung in Echtzeit nach √Ñnderung der Einstellungen
* Verwendung von **pdfmake** oder **Puppeteer** zur Generierung der Vorschau

**Ziel:** Direkte visuelle Kontrolle, ohne das System verlassen zu m√ºssen.

---

## **3Ô∏è‚É£ Integration in andere Module**

| Modul          | Integration / Verbindung                                                                                              |
| -------------- | --------------------------------------------------------------------------------------------------------------------- |
| **Angebote**   | Beim Erstellen wird die ausgew√§hlte Angebotsvorlage + Firmendaten automatisch eingelesen. Vorschau zeigt Live-Layout. |
| **Rechnungen** | √úbernimmt die gew√§hlte Rechnungsvorlage + Bankinformationen und Zahlungsziel.                                         |
| **Projekte**   | Dokumente, die im Projektverlauf erzeugt werden, greifen auf dieselben Einstellungen zu.                              |
| **PDF-Export** | Zentraler Renderer nutzt die gespeicherten Template-Konfigurationen f√ºr alle Dokumente.                               |

**Ziel:** Einheitliches Erscheinungsbild in allen Dokumenten und automatisierte Bef√ºllung.

---

## **4Ô∏è‚É£ Benutzerrechte & Sicherheit**

* Nur **Admin-Benutzer** d√ºrfen die Einstellungen bearbeiten.
* √Ñnderungen werden versioniert gespeichert (Audit-Log).
* M√∂glichkeit, alte Template-Versionen wiederherzustellen.

---

## **5Ô∏è‚É£ Technische Hinweise (ohne Code)**

* **Frontend:**

  * Next.js + React
  * TailwindCSS f√ºr Layout
  * ShadCN UI Tabs / Accordions f√ºr Unterabschnitte
  * Live-Vorschau-Komponente mit eingebetteter PDF-Darstellung
* **Backend:**

  * Node.js / NestJS API-Endpoints: `/api/settings/company`, `/api/settings/templates`
  * Speicherung in MongoDB (Collection `settings`)
* **PDF-Generierung:**

  * pdfmake / jsPDF / Puppeteer f√ºr dynamische PDFs
* **Storage:**

  * MinIO f√ºr Logos und Zertifikate
* **Auth:**

  * Nur `role: admin` darf speichern oder l√∂schen

---

## **6Ô∏è‚É£ Erweiterungsideen**

* Mehr Vorlagen mit eigenem Editor (Drag-and-Drop-Layout)
* M√∂glichkeit, Custom-HTML-Templates hochzuladen
* Firmenbranding-Export (z. B. f√ºr E-Mail-Signaturen oder Briefpapier)
* Automatische Synchronisierung mit Rechnungsdienst (LexOffice, DATEV-Layout)

---

## **7Ô∏è‚É£ Erfolgskriterien**

* Admin kann **Firmendaten, Logos, Bankinfos und Templates** zentral pflegen.
* √Ñnderungen werden automatisch in **Angebots- und Rechnungs-PDFs** √ºbernommen.
* Nutzer k√∂nnen beim Erstellen eines Angebots oder einer Rechnung **zwischen drei Layouts** w√§hlen.
* Die **PDF-Vorschau** zeigt sofort das Ergebnis der Einstellungen.
* Alle Dokumente im System sind **visuell einheitlich und rechtssicher**.

---

M√∂chtest du, dass ich dir daraus gleich den passenden **Cursor-Prompt** im Flie√ütext formuliere (√§hnlich wie bei ‚ÄûKunden‚Äú), damit du ihn direkt in dein Cursor-Projekt kopieren kannst?
